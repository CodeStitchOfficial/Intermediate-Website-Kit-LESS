<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
        <title>Content Manager</title>
    </head>
    <body>
        <!-- Include the script that builds the page and powers Decap CMS -->
        <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js"></script>

        <!-- Decap CMS preview pane script -->
        <!-- Edit this script to customize the preview pane for your blog posts.  -->
        <!-- Documentation: https://decapcms.org/docs/customization/ -->
        <script>
            var BlogPreview = createClass({
                render: function () {
                    // Get all the props from the collection
                    const data = this
                        .props
                        .entry
                        .get("data")
                        .toJS();
                    const title = data.title;
                    const author = data.author;
                    const date = typeof data.date === "string"
                        ? new Date(data.date)
                        : data.date;
                    let formattedDate = "";
                    if (date) {
                        formattedDate = Intl
                            .DateTimeFormat("en-US", {
                                month: "long",
                                day: "numeric",
                                year: "numeric"
                            })
                            .format(date);
                    }
                    const coverImage = data.image;
                    const cover = this
                        .props
                        .getAsset(coverImage);

                    // Create elements for the preview pane
                    return h("div", {
                        className: "blog"
                    }, h("h1", {
                        className: "title"
                    }, title), h("div", {
                        className: "metadata"
                    }, h("span", {
                        className: "author"
                    }, author), h("span", {className: "dot"}), h("span", {
                        className: "date"
                    }, formattedDate)), h("img", {
                        src: cover.toString(),
                        className: "cover"
                    }), h("hr", {className: "divider"}), h("div", {
                        className: "markdown"
                    }, this.props.widgetFor("body")));
                }
            });

            // Register the elements and styles for the "blog" collection
            CMS.registerPreviewTemplate("blog", BlogPreview);
            CMS.registerPreviewStyle("/admin/decap-preview-styles.css");
        </script>
    </body>
</html>